# Telegram-бот для учета расходов

Telegram-бот для автоматического учета расходов с поддержкой текстовых, голосовых сообщений и изображений через OpenAI API.

## Возможности

- Обработка текстовых сообщений с расходами
- Распознавание голосовых сообщений через Whisper
- Чтение текста с изображений через GPT-4 Vision
- Автоматическое извлечение суммы расхода из сообщений
- Суммарная статистика за день и месяц
- Хранение данных в SQLite

## Установка

1. Клонируйте репозиторий или скачайте файлы

2. Установите зависимости (через `uv` или `pip`):

**С помощью uv (рекомендуется):**
```bash
uv venv
source .venv/bin/activate
uv pip install -r requirements.txt
```

**Или с помощью pip:**
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Заполните `.env` файл:
```
TELEGRAM_BOT_TOKEN=ваш_токен_бота_от_BotFather
OPENAI_API_KEY=ваш_ключ_от_OpenAI
```

5. Получите токен Telegram-бота:
   - Откройте [@BotFather](https://t.me/BotFather) в Telegram
   - Отправьте команду `/newbot`
   - Следуйте инструкциям для создания бота
   - Скопируйте полученный токен в `.env`

6. Получите API ключ OpenAI:
   - Зайдите на [platform.openai.com](https://platform.openai.com)
   - Перейдите в раздел API keys
   - Создайте новый ключ и скопируйте его в `.env`

## Запуск

**С помощью uv:**
```bash
source .venv/bin/activate
python bot.py
```

Или используйте скрипт запуска:
```bash
./run.sh
```

**Или напрямую:**
```bash
python bot.py
```

## Использование

1. Найдите вашего бота в Telegram и отправьте команду `/start`

2. Отправляйте расходы любым способом:
   - Текстом: "Купил кофе 500 рублей"
   - Голосом: запишите голосовое сообщение с расходом
   - Фото: отправьте фото чека или скриншот с суммой

3. Просмотр статистики:
   - `/today` - расходы за сегодня
   - `/month` - расходы за текущий месяц
   - `/help` - справка

## Структура проекта

- `bot.py` - основной файл бота
- `config.py` - конфигурация и загрузка переменных окружения
- `openai_client.py` - клиент для работы с OpenAI API
- `storage.py` - работа с SQLite базой данных
- `expense_parser.py` - парсинг суммы расхода из текста
- `requirements.txt` - зависимости Python
- `expenses.db` - база данных SQLite (создается автоматически)

## Примечания

- Данные хранятся локально в файле `expenses.db`
- Бот использует GPT-4 и GPT-4 Vision, что может влиять на стоимость использования API
- Убедитесь, что у вас есть достаточный баланс на счету OpenAI

